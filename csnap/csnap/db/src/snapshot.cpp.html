<!DOCTYPE html>
<html><head><title>C:/projects/csnap/db/src/snapshot.cpp</title><link id="codestylesheet" rel="stylesheet" type="text/css" href="../../../syntax.qtcreator.css"/><link rel="stylesheet" type="text/css" href="../../../tooltip.css"/><script type="text/javascript">var csnapRootPath="../../../";</script><script type="text/javascript" src="../../../codenav.js"> </script></head><body><div id="content"><h2>Code</h2><table class="code" file-id="20"><tbody><tr><th id="L1">1</th><td><i>// Copyright (C) 2023 Vincent Chambrin</i></td></tr><tr><th id="L2">2</th><td><i>// This file is part of the 'csnap' project.</i></td></tr><tr><th id="L3">3</th><td><i>// For conditions of distribution and use, see copyright notice in LICENSE.</i></td></tr><tr><th id="L4">4</th><td/></tr><tr><th id="L5">5</th><td><u>#include</u> <a class="include" href="../include/csnap/database/snapshot.h.html"><span class="include">"snapshot.h"</span></a></td></tr><tr><th id="L6">6</th><td/></tr><tr><th id="L7">7</th><td><u>#include</u> <a class="include" href="../include/csnap/database/sql.h.html"><span class="include">"sql.h"</span></a></td></tr><tr><th id="L8">8</th><td><u>#include</u> <a class="include" href="../include/csnap/database/sqlqueries.h.html"><span class="include">"sqlqueries.h"</span></a></td></tr><tr><th id="L9">9</th><td><u>#include</u> <a class="include" href="../include/csnap/database/symbolloader.h.html"><span class="include">"symbolloader.h"</span></a></td></tr><tr><th id="L10">10</th><td><u>#include</u> <a class="include" href="../include/csnap/database/transaction.h.html"><span class="include">"transaction.h"</span></a></td></tr><tr><th id="L11">11</th><td/></tr><tr><th id="L12">12</th><td><u>#include</u> <span class="include">&lt;algorithm&gt;</span></td></tr><tr><th id="L13">13</th><td><u>#include</u> <span class="include">&lt;fstream&gt;</span></td></tr><tr><th id="L14">14</th><td><u>#include</u> <span class="include">&lt;map&gt;</span></td></tr><tr><th id="L15">15</th><td><u>#include</u> <span class="include">&lt;sstream&gt;</span></td></tr><tr><th id="L16">16</th><td/></tr><tr><th id="L17">17</th><td><b>namespace</b> <dfn class="namespace" sym-ref="4505.csnap">csnap</dfn></td></tr><tr><th id="L18">18</th><td>{</td></tr><tr><th id="L19">19</th><td/></tr><tr><th id="L20">20</th><td><b>struct</b> <dfn class="type struct" sym-ref="4684.PendingData">PendingData</dfn></td></tr><tr><th id="L21">21</th><td>{</td></tr><tr><th id="L22">22</th><td>  <i>/**</i></td></tr><tr><th id="L23">23</th><td><i>   * \brief the properties that have yet to be written into the database </i></td></tr><tr><th id="L24">24</th><td><i>   */</i></td></tr><tr><th id="L25">25</th><td>  std::map&lt;std::string, std::string&gt; <dfn class="member field" sym-ref="4841.properties">properties</dfn>;</td></tr><tr><th id="L26">26</th><td/></tr><tr><th id="L27">27</th><td>  <i>/**</i></td></tr><tr><th id="L28">28</th><td><i>   * \brief ids of files that have yet to be written into the database</i></td></tr><tr><th id="L29">29</th><td><i>   */</i></td></tr><tr><th id="L30">30</th><td>  std::vector&lt;FileId&gt; <dfn class="member field" sym-ref="4842.files">files</dfn>;</td></tr><tr><th id="L31">31</th><td/></tr><tr><th id="L32">32</th><td>  <i>/**</i></td></tr><tr><th id="L33">33</th><td><i>   * \brief ids of translation units that have yet to be written into the database</i></td></tr><tr><th id="L34">34</th><td><i>   */</i></td></tr><tr><th id="L35">35</th><td>  std::vector&lt;TranslationUnit*&gt; <dfn class="member field" sym-ref="4843.translation_units">translation_units</dfn>;</td></tr><tr><th id="L36">36</th><td/></tr><tr><th id="L37">37</th><td>  <i>/**</i></td></tr><tr><th id="L38">38</th><td><i>   * \brief include directives that have yet to be written into the database</i></td></tr><tr><th id="L39">39</th><td><i>   */</i></td></tr><tr><th id="L40">40</th><td>  std::map&lt;TranslationUnit*, std::vector&lt;Include&gt;&gt; <dfn class="member field" sym-ref="4844.includes">includes</dfn>;</td></tr><tr><th id="L41">41</th><td/></tr><tr><th id="L42">42</th><td>  <i>/**</i></td></tr><tr><th id="L43">43</th><td><i>   * \brief pointers to symbols that have yet to be written into the database</i></td></tr><tr><th id="L44">44</th><td><i>   */</i></td></tr><tr><th id="L45">45</th><td>  std::vector&lt;std::shared_ptr&lt;Symbol&gt;&gt; <dfn class="member field" sym-ref="4845.symbols">symbols</dfn>;</td></tr><tr><th id="L46">46</th><td/></tr><tr><th id="L47">47</th><td>  <i>/**</i></td></tr><tr><th id="L48">48</th><td><i>   * \brief the list of base classes that have yet to be written into the database</i></td></tr><tr><th id="L49">49</th><td><i>   */</i></td></tr><tr><th id="L50">50</th><td>  std::map&lt;SymbolId, std::vector&lt;BaseClass&gt;&gt; <dfn class="member field" sym-ref="4846.bases">bases</dfn>;</td></tr><tr><th id="L51">51</th><td/></tr><tr><th id="L52">52</th><td>  std::vector&lt;SymbolReference&gt; <dfn class="member field" sym-ref="4847.symbol_references">symbol_references</dfn>;</td></tr><tr><th id="L53">53</th><td>};</td></tr><tr><th id="L54">54</th><td/></tr><tr><th id="L55">55</th><td><a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member constructor" sym-ref="4689.Snapshot">Snapshot</dfn>(<a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>&amp;&amp;) = <b>default</b>;</td></tr><tr><th id="L56">56</th><td/></tr><tr><th id="L57">57</th><td><a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member destructor" sym-ref="4690.~Snapshot">~Snapshot</dfn>()</td></tr><tr><th id="L58">58</th><td>{</td></tr><tr><th id="L59">59</th><td>  <b>if</b> (<a href="snapshot.cpp.html#L534" class="member memfn" sym-ref="4726.hasPendingData">hasPendingData</a>())</td></tr><tr><th id="L60">60</th><td>    <a href="snapshot.cpp.html#L539" class="member memfn" sym-ref="4727.writePendingData">writePendingData</a>();</td></tr><tr><th id="L61">61</th><td>}</td></tr><tr><th id="L62">62</th><td/></tr><tr><th id="L63">63</th><td><a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member constructor" sym-ref="4691.Snapshot">Snapshot</dfn>(<a href="../include/csnap/database/database.h.html#L25" class="type cxxclass" sym-ref="4506.Database">Database</a> db) :</td></tr><tr><th id="L64">64</th><td>  <a href="../include/csnap/database/snapshot.h.html#L95" class="member field" sym-ref="4729.m_database">m_database</a>(<a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="fn" sym-ref="4850.make_unique">make_unique</span>&lt;Database&gt;(std::move(db)))</td></tr><tr><th id="L65">65</th><td>{</td></tr><tr><th id="L66">66</th><td>  <b>if</b> (!m_database-&gt;good())</td></tr><tr><th id="L67">67</th><td>    <b>throw</b> std::runtime_error(<var>"snapshot constructor expects a good() database"</var>);</td></tr><tr><th id="L68">68</th><td/></tr><tr><th id="L69">69</th><td>  {</td></tr><tr><th id="L70">70</th><td>    std::vector&lt;File&gt; all_files = select_file(*m_database);</td></tr><tr><th id="L71">71</th><td/></tr><tr><th id="L72">72</th><td>    <b>for</b> (File&amp; f : all_files)</td></tr><tr><th id="L73">73</th><td>    {</td></tr><tr><th id="L74">74</th><td>      m_files.add(std::make_unique&lt;File&gt;(std::move(f)));</td></tr><tr><th id="L75">75</th><td>    }</td></tr><tr><th id="L76">76</th><td>  }</td></tr><tr><th id="L77">77</th><td/></tr><tr><th id="L78">78</th><td>  {</td></tr><tr><th id="L79">79</th><td>    std::vector&lt;TranslationUnit&gt; all_units = select_translationunit(*m_database);</td></tr><tr><th id="L80">80</th><td/></tr><tr><th id="L81">81</th><td>    <b>for</b> (TranslationUnit&amp; tu : all_units)</td></tr><tr><th id="L82">82</th><td>    {</td></tr><tr><th id="L83">83</th><td>      m_translationunits.add(std::make_unique&lt;TranslationUnit&gt;(std::move(tu)));</td></tr><tr><th id="L84">84</th><td>    }</td></tr><tr><th id="L85">85</th><td>  }</td></tr><tr><th id="L86">86</th><td/></tr><tr><th id="L87">87</th><td>}</td></tr><tr><th id="L88">88</th><td/></tr><tr><th id="L89">89</th><td><i>/**</i></td></tr><tr><th id="L90">90</th><td><i> * \brief returns the database associated with the snapshot</i></td></tr><tr><th id="L91">91</th><td><i> */</i></td></tr><tr><th id="L92">92</th><td><a href="../include/csnap/database/database.h.html#L25" class="type cxxclass" sym-ref="4506.Database">Database</a>&amp; <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4692.database">database</dfn>() <em>const</em></td></tr><tr><th id="L93">93</th><td>{</td></tr><tr><th id="L94">94</th><td>  <b>return</b> <span class="member memfn" sym-ref="2183.operator*">*</span><a href="../include/csnap/database/snapshot.h.html#L95" class="member field" sym-ref="4729.m_database">m_database</a>;</td></tr><tr><th id="L95">95</th><td>}</td></tr><tr><th id="L96">96</th><td/></tr><tr><th id="L97">97</th><td><i>/**</i></td></tr><tr><th id="L98">98</th><td><i> * \brief opens a snapshot</i></td></tr><tr><th id="L99">99</th><td><i> * \param p  the path of the snapshot</i></td></tr><tr><th id="L100">100</th><td><i> */</i></td></tr><tr><th id="L101">101</th><td><a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4851.open">open</dfn>(<em>const</em> std::filesystem::path&amp; p)</td></tr><tr><th id="L102">102</th><td>{</td></tr><tr><th id="L103">103</th><td>  <a href="../include/csnap/database/database.h.html#L25" class="type cxxclass" sym-ref="4506.Database">Database</a> <a href="../include/csnap/database/database.h.html#L28" class="member constructor" sym-ref="4507.Database">db</a>;</td></tr><tr><th id="L104">104</th><td>  db.open(p);</td></tr><tr><th id="L105">105</th><td>  <b>return</b> Snapshot(std::move(db));</td></tr><tr><th id="L106">106</th><td>}</td></tr><tr><th id="L107">107</th><td/></tr><tr><th id="L108">108</th><td><i>/**</i></td></tr><tr><th id="L109">109</th><td><i> * \brief creates a new empty snapshot</i></td></tr><tr><th id="L110">110</th><td><i> * \param p  file path</i></td></tr><tr><th id="L111">111</th><td><i> */</i></td></tr><tr><th id="L112">112</th><td><a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4852.create">create</dfn>(<em>const</em> std::filesystem::path&amp; p)</td></tr><tr><th id="L113">113</th><td>{</td></tr><tr><th id="L114">114</th><td>  <a href="../include/csnap/database/database.h.html#L25" class="type cxxclass" sym-ref="4506.Database">Database</a> <a href="../include/csnap/database/database.h.html#L28" class="member constructor" sym-ref="4507.Database">db</a>;</td></tr><tr><th id="L115">115</th><td>  db.create(p);</td></tr><tr><th id="L116">116</th><td/></tr><tr><th id="L117">117</th><td>  <b>if</b> (!sql::exec(db, db_init_statements()))</td></tr><tr><th id="L118">118</th><td>    <b>throw</b> std::runtime_error(<var>"failed to create snapshot database"</var>);</td></tr><tr><th id="L119">119</th><td/></tr><tr><th id="L120">120</th><td>  <b>return</b> Snapshot(std::move(db));</td></tr><tr><th id="L121">121</th><td>}</td></tr><tr><th id="L122">122</th><td/></tr><tr><th id="L123">123</th><td><i>/**</i></td></tr><tr><th id="L124">124</th><td><i> * \brief sets a property of the snapshot</i></td></tr><tr><th id="L125">125</th><td><i> * \param key    the property name</i></td></tr><tr><th id="L126">126</th><td><i> * \param value  its value</i></td></tr><tr><th id="L127">127</th><td><i> */</i></td></tr><tr><th id="L128">128</th><td><em>void</em> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4695.setProperty">setProperty</dfn>(<em>const</em> <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxtypealias" sym-ref="32.string">string</span>&amp; key, <em>const</em> <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxtypealias" sym-ref="32.string">string</span>&amp; value)</td></tr><tr><th id="L129">129</th><td>{</td></tr><tr><th id="L130">130</th><td>  <a href="snapshot.cpp.html#L577" class="member memfn" sym-ref="4728.pendingData">pendingData</a>().properties[key] = value;</td></tr><tr><th id="L131">131</th><td>}</td></tr><tr><th id="L132">132</th><td/></tr><tr><th id="L133">133</th><td><i>/**</i></td></tr><tr><th id="L134">134</th><td><i> * \brief retrieves the value of a property</i></td></tr><tr><th id="L135">135</th><td><i> * \param key  the name of the property</i></td></tr><tr><th id="L136">136</th><td><i> * </i></td></tr><tr><th id="L137">137</th><td><i> * If no such property exists, this returns an empty string.</i></td></tr><tr><th id="L138">138</th><td><i> */</i></td></tr><tr><th id="L139">139</th><td><a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxtypealias" sym-ref="32.string">string</span> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4696.property">property</dfn>(<em>const</em> <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxtypealias" sym-ref="32.string">string</span>&amp; key) <em>const</em></td></tr><tr><th id="L140">140</th><td>{</td></tr><tr><th id="L141">141</th><td>  <b>if</b> (<a href="snapshot.cpp.html#L534" class="member memfn" sym-ref="4726.hasPendingData">hasPendingData</a>())</td></tr><tr><th id="L142">142</th><td>  {</td></tr><tr><th id="L143">143</th><td>    <b>auto</b> it = <a href="../include/csnap/database/snapshot.h.html#L100" class="member field" sym-ref="4734.m_pending_data">m_pending_data</a>-&gt;properties.find(key);</td></tr><tr><th id="L144">144</th><td>    <b>if</b> (it != m_pending_data-&gt;properties.end())</td></tr><tr><th id="L145">145</th><td>      <b>return</b> it-&gt;second;</td></tr><tr><th id="L146">146</th><td>  }</td></tr><tr><th id="L147">147</th><td/></tr><tr><th id="L148">148</th><td>  <b>return</b> <a href="sqlqueries.cpp.html#L177" class="fn" sym-ref="4801.select_info">select_info</a>(*m_database, key);</td></tr><tr><th id="L149">149</th><td>}</td></tr><tr><th id="L150">150</th><td/></tr><tr><th id="L151">151</th><td><i>/**</i></td></tr><tr><th id="L152">152</th><td><i> * \brief returns a path with all backward slashes replaced by forward slashes</i></td></tr><tr><th id="L153">153</th><td><i> */</i></td></tr><tr><th id="L154">154</th><td><a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxtypealias" sym-ref="32.string">string</span> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member staticfn" sym-ref="4697.getCanonicalPath">getCanonicalPath</dfn>(<a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxtypealias" sym-ref="32.string">string</span> path)</td></tr><tr><th id="L155">155</th><td>{</td></tr><tr><th id="L156">156</th><td>  <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="fn" sym-ref="4748.for_each">for_each</span>(path.<span class="member memfn" sym-ref="1964.begin">begin</span>(), path.<span class="member memfn" sym-ref="1965.end">end</span>(), [](<em>char</em>&amp; c) {</td></tr><tr><th id="L157">157</th><td>    <b>if</b> (c == '\\') c = <var>'/'</var>;</td></tr><tr><th id="L158">158</th><td>    });</td></tr><tr><th id="L159">159</th><td/></tr><tr><th id="L160">160</th><td>  <b>return</b> <span class="member constructor" sym-ref="64.basic_string<_Elem, _Traits, _Alloc>">path</span>;</td></tr><tr><th id="L161">161</th><td>}</td></tr><tr><th id="L162">162</th><td/></tr><tr><th id="L163">163</th><td><i>/**</i></td></tr><tr><th id="L164">164</th><td><i> * \brief reads a file completely into memory</i></td></tr><tr><th id="L165">165</th><td><i> */</i></td></tr><tr><th id="L166">166</th><td><a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxtypealias" sym-ref="32.string">string</span> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4853.readFile">readFile</dfn>(<em>const</em> std::filesystem::path&amp; filepath)</td></tr><tr><th id="L167">167</th><td>{</td></tr><tr><th id="L168">168</th><td>  <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxtypealias" sym-ref="2106.ifstream">ifstream</span> file{ filepath.string(), std::ios::binary };</td></tr><tr><th id="L169">169</th><td>  <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxtypealias" sym-ref="1954.stringstream">stringstream</span> buffer;</td></tr><tr><th id="L170">170</th><td>  buffer &lt;&lt; file.rdbuf();</td></tr><tr><th id="L171">171</th><td>  <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxtypealias" sym-ref="32.string">string</span> bytes{ buffer.str() };</td></tr><tr><th id="L172">172</th><td>  <b>return</b> <span class="member constructor" sym-ref="64.basic_string<_Elem, _Traits, _Alloc>">bytes</span>;</td></tr><tr><th id="L173">173</th><td>}</td></tr><tr><th id="L174">174</th><td/></tr><tr><th id="L175">175</th><td><i>/**</i></td></tr><tr><th id="L176">176</th><td><i> * \brief adds a new file to the snapshot</i></td></tr><tr><th id="L177">177</th><td><i> * \param f  struct filled with information about the file</i></td></tr><tr><th id="L178">178</th><td><i> * \return a pointer to the newly added file</i></td></tr><tr><th id="L179">179</th><td><i> * </i></td></tr><tr><th id="L180">180</th><td><i> * \note The \a id field of \a f is ignored; an id is automatically </i></td></tr><tr><th id="L181">181</th><td><i> * assigned by the snapshot to the returned File object.</i></td></tr><tr><th id="L182">182</th><td><i> */</i></td></tr><tr><th id="L183">183</th><td><a href="../../model/include/csnap/model/file.h.html#L15" class="type struct" sym-ref="4532.File">File</a>* <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4699.addFile">addFile</dfn>(<a href="../../model/include/csnap/model/file.h.html#L15" class="type struct" sym-ref="4532.File">File</a> f)</td></tr><tr><th id="L184">184</th><td>{</td></tr><tr><th id="L185">185</th><td>  <a href="../../model/include/csnap/model/file.h.html#L15" class="type struct" sym-ref="4532.File">File</a>* file = <a href="../include/csnap/database/snapshot.h.html#L96" class="member field" sym-ref="4730.m_files">m_files</a>.add(<a href="snapshot.cpp.html#L154" class="member staticfn" sym-ref="4697.getCanonicalPath">getCanonicalPath</a>(<a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="fn" sym-ref="1399.move">move</span>(f.path)));</td></tr><tr><th id="L186">186</th><td/></tr><tr><th id="L187">187</th><td>  <a href="snapshot.cpp.html#L577" class="member memfn" sym-ref="4728.pendingData">pendingData</a>().files.push_back(<a href="../../model/include/csnap/model/fileid.h.html#L15" class="type cxxtypealias" sym-ref="4533.FileId">FileId</a>(file-&gt;id));</td></tr><tr><th id="L188">188</th><td/></tr><tr><th id="L189">189</th><td>  <b>return</b> file;</td></tr><tr><th id="L190">190</th><td>}</td></tr><tr><th id="L191">191</th><td/></tr><tr><th id="L192">192</th><td><em>void</em> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4854.addFile">addFile</dfn>(std::unique_ptr&lt;File&gt; f)</td></tr><tr><th id="L193">193</th><td>{</td></tr><tr><th id="L194">194</th><td>  f-&gt;path = getCanonicalPath(std::move(f-&gt;path));</td></tr><tr><th id="L195">195</th><td>  <a href="../../model/include/csnap/model/fileid.h.html#L15" class="type cxxtypealias" sym-ref="4533.FileId">FileId</a> id = m_files.add(std::move(f))-&gt;id;</td></tr><tr><th id="L196">196</th><td>  <a href="snapshot.cpp.html#L577" class="member memfn" sym-ref="4728.pendingData">pendingData</a>().files.push_back(id);</td></tr><tr><th id="L197">197</th><td>}</td></tr><tr><th id="L198">198</th><td/></tr><tr><th id="L199">199</th><td><i>/**</i></td></tr><tr><th id="L200">200</th><td><i> * \brief add files to the snapshot</i></td></tr><tr><th id="L201">201</th><td><i> * \param files  the files to add</i></td></tr><tr><th id="L202">202</th><td><i> * </i></td></tr><tr><th id="L203">203</th><td><i> * \sa addFile().</i></td></tr><tr><th id="L204">204</th><td><i> */</i></td></tr><tr><th id="L205">205</th><td><em>void</em> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4855.addFiles">addFiles</dfn>(<em>const</em> std::vector&lt;File&gt;&amp; files)</td></tr><tr><th id="L206">206</th><td>{</td></tr><tr><th id="L207">207</th><td>  <b>for</b> (File f : files)</td></tr><tr><th id="L208">208</th><td>  {</td></tr><tr><th id="L209">209</th><td>    addFile(std::move(f));</td></tr><tr><th id="L210">210</th><td>  }</td></tr><tr><th id="L211">211</th><td>}</td></tr><tr><th id="L212">212</th><td/></tr><tr><th id="L213">213</th><td><i>/**</i></td></tr><tr><th id="L214">214</th><td><i> * \brief retrieves a file from the snapshot given its id</i></td></tr><tr><th id="L215">215</th><td><i> * \param id  the id of the file</i></td></tr><tr><th id="L216">216</th><td><i> * \return a pointer to the file, or nullptr if no such file exists</i></td></tr><tr><th id="L217">217</th><td><i> */</i></td></tr><tr><th id="L218">218</th><td><a href="../../model/include/csnap/model/file.h.html#L15" class="type struct" sym-ref="4532.File">File</a>* <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4702.getFile">getFile</dfn>(<a href="../../model/include/csnap/model/fileid.h.html#L15" class="type cxxtypealias" sym-ref="4533.FileId">FileId</a> id) <em>const</em></td></tr><tr><th id="L219">219</th><td>{</td></tr><tr><th id="L220">220</th><td>  <b>return</b> <a href="snapshot.cpp.html#L243" class="member memfn" sym-ref="4704.files">files</a>().<a href="../../model/src/filelist.cpp.html#L55" class="member memfn" sym-ref="4555.get">get</a>(<a href="../../model/include/csnap/model/identifier.h.html#L19" class="member constructor" sym-ref="4522.Identifier<T>">id</a>);</td></tr><tr><th id="L221">221</th><td>}</td></tr><tr><th id="L222">222</th><td/></tr><tr><th id="L223">223</th><td><i>/**</i></td></tr><tr><th id="L224">224</th><td><i> * \brief finds a file given its path</i></td></tr><tr><th id="L225">225</th><td><i> * \param path  the file path</i></td></tr><tr><th id="L226">226</th><td><i> * \return a pointer to the file, or nullptr if no file matching the path is found</i></td></tr><tr><th id="L227">227</th><td><i> * </i></td></tr><tr><th id="L228">228</th><td><i> * \note All backward slashes in \a path are automatically converted to forward slashes.</i></td></tr><tr><th id="L229">229</th><td><i> */</i></td></tr><tr><th id="L230">230</th><td><a href="../../model/include/csnap/model/file.h.html#L15" class="type struct" sym-ref="4532.File">File</a>* <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4703.findFile">findFile</dfn>(<em>const</em> <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxtypealias" sym-ref="32.string">string</span>&amp; path) <em>const</em></td></tr><tr><th id="L231">231</th><td>{</td></tr><tr><th id="L232">232</th><td>  <em>bool</em> looks_canonical = <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="fn" sym-ref="2561.find">find</span>(path.<span class="member memfn" sym-ref="2531.begin">begin</span>(), path.<span class="member memfn" sym-ref="2532.end">end</span>(), '\\') <a href="../../model/include/csnap/model/reference.h.html#L55" class="fn" sym-ref="4529.operator==">==</a> path.end();</td></tr><tr><th id="L233">233</th><td/></tr><tr><th id="L234">234</th><td>  <b>if</b> (looks_canonical)</td></tr><tr><th id="L235">235</th><td>    <b>return</b> <a href="snapshot.cpp.html#L243" class="member memfn" sym-ref="4704.files">files</a>().<a href="../../model/src/filelist.cpp.html#L68" class="member memfn" sym-ref="4556.find">find</a>(path);</td></tr><tr><th id="L236">236</th><td>  <b>else</b></td></tr><tr><th id="L237">237</th><td>    <b>return</b> <a href="snapshot.cpp.html#L243" class="member memfn" sym-ref="4704.files">files</a>().<a href="../../model/src/filelist.cpp.html#L68" class="member memfn" sym-ref="4556.find">find</a>(<a href="snapshot.cpp.html#L154" class="member staticfn" sym-ref="4697.getCanonicalPath">getCanonicalPath</a>(<span class="member constructor" sym-ref="622.basic_string<_Elem, _Traits, _Alloc>">path</span>));</td></tr><tr><th id="L238">238</th><td>}</td></tr><tr><th id="L239">239</th><td/></tr><tr><th id="L240">240</th><td><i>/**</i></td></tr><tr><th id="L241">241</th><td><i> * \brief returns the list of all files in the snapshot</i></td></tr><tr><th id="L242">242</th><td><i> */</i></td></tr><tr><th id="L243">243</th><td><em>const</em> <a href="../../model/include/csnap/model/filelist.h.html#L19" class="type cxxclass" sym-ref="4551.FileList">FileList</a>&amp; <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4704.files">files</dfn>() <em>const</em></td></tr><tr><th id="L244">244</th><td>{</td></tr><tr><th id="L245">245</th><td>  <b>return</b> <a href="../include/csnap/database/snapshot.h.html#L96" class="member field" sym-ref="4730.m_files">m_files</a>;</td></tr><tr><th id="L246">246</th><td>}</td></tr><tr><th id="L247">247</th><td/></tr><tr><th id="L248">248</th><td><i>/**</i></td></tr><tr><th id="L249">249</th><td><i> * \brief saves a copy of every file in the database</i></td></tr><tr><th id="L250">250</th><td><i> * </i></td></tr><tr><th id="L251">251</th><td><i> * Note that this function only saves a copy of files presently in the </i></td></tr><tr><th id="L252">252</th><td><i> * snapshot.</i></td></tr><tr><th id="L253">253</th><td><i> * If new files are subsequently added (e.g., using addFiles()), those </i></td></tr><tr><th id="L254">254</th><td><i> * will not get copied unless addFilesContent() is called again.</i></td></tr><tr><th id="L255">255</th><td><i> */</i></td></tr><tr><th id="L256">256</th><td><em>void</em> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4705.addFilesContent">addFilesContent</dfn>()</td></tr><tr><th id="L257">257</th><td>{</td></tr><tr><th id="L258">258</th><td>  <a href="sqlqueries.cpp.html#L336" class="fn" sym-ref="4808.insert_file_content">insert_file_content</a>(<span class="member memfn" sym-ref="2183.operator*">*</span><a href="../include/csnap/database/snapshot.h.html#L95" class="member field" sym-ref="4729.m_database">m_database</a>, <a href="snapshot.cpp.html#L243" class="member memfn" sym-ref="4704.files">files</a>().<a href="../../model/src/filelist.cpp.html#L43" class="member memfn" sym-ref="4554.all">all</a>());</td></tr><tr><th id="L259">259</th><td>}</td></tr><tr><th id="L260">260</th><td/></tr><tr><th id="L261">261</th><td><i>/**</i></td></tr><tr><th id="L262">262</th><td><i> * \brief retrieves a copy of a file</i></td></tr><tr><th id="L263">263</th><td><i> * \param f  the id of the file</i></td></tr><tr><th id="L264">264</th><td><i> * </i></td></tr><tr><th id="L265">265</th><td><i> * By default, the files are not copied in the snapshot;</i></td></tr><tr><th id="L266">266</th><td><i> * use addFilesContent() to save a copy of each file in the snapshot.</i></td></tr><tr><th id="L267">267</th><td><i> */</i></td></tr><tr><th id="L268">268</th><td><a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxclass" sym-ref="506.shared_ptr">shared_ptr</span>&lt;<a href="../../model/include/csnap/model/filecontent.h.html#L20" class="type cxxclass" sym-ref="4537.FileContent">FileContent</a>&gt; <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4706.getFileContent">getFileContent</dfn>(<a href="../../model/include/csnap/model/fileid.h.html#L15" class="type cxxtypealias" sym-ref="4533.FileId">FileId</a> f)</td></tr><tr><th id="L269">269</th><td>{</td></tr><tr><th id="L270">270</th><td>  <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxclass" sym-ref="506.shared_ptr">shared_ptr</span>&lt;<a href="../../model/include/csnap/model/filecontent.h.html#L20" class="type cxxclass" sym-ref="4537.FileContent">FileContent</a>&gt; result = m_filecontent_cache.find(f);</td></tr><tr><th id="L271">271</th><td/></tr><tr><th id="L272">272</th><td>  <b>if</b> (result)</td></tr><tr><th id="L273">273</th><td>    <b>return</b> result;</td></tr><tr><th id="L274">274</th><td/></tr><tr><th id="L275">275</th><td>  <a href="../../model/include/csnap/model/file.h.html#L15" class="type struct" sym-ref="4532.File">File</a>* file = <a href="snapshot.cpp.html#L243" class="member memfn" sym-ref="4704.files">files</a>().<a href="../../model/src/filelist.cpp.html#L55" class="member memfn" sym-ref="4555.get">get</a>(<a href="../../model/include/csnap/model/identifier.h.html#L19" class="member constructor" sym-ref="4522.Identifier<T>">f</a>);</td></tr><tr><th id="L276">276</th><td/></tr><tr><th id="L277">277</th><td>  <b>if</b> (!file)</td></tr><tr><th id="L278">278</th><td>    <b>return</b> <b>nullptr</b>;</td></tr><tr><th id="L279">279</th><td/></tr><tr><th id="L280">280</th><td>  <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxtypealias" sym-ref="32.string">string</span> content = <span class="member constructor" sym-ref="64.basic_string<_Elem, _Traits, _Alloc>">select_content_from_file</span>(*m_database, f);</td></tr><tr><th id="L281">281</th><td/></tr><tr><th id="L282">282</th><td>  <b>if</b> (content.empty())</td></tr><tr><th id="L283">283</th><td>    <b>return</b> <b>nullptr</b>;</td></tr><tr><th id="L284">284</th><td/></tr><tr><th id="L285">285</th><td>  result = std::make_shared&lt;FileContent&gt;(file, std::move(content));</td></tr><tr><th id="L286">286</th><td/></tr><tr><th id="L287">287</th><td>  m_filecontent_cache.insert(result);</td></tr><tr><th id="L288">288</th><td/></tr><tr><th id="L289">289</th><td>  <b>return</b> result;</td></tr><tr><th id="L290">290</th><td>}</td></tr><tr><th id="L291">291</th><td/></tr><tr><th id="L292">292</th><td><em>void</em> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4856.addTranslationUnits">addTranslationUnits</dfn>(<em>const</em> std::vector&lt;FileId&gt;&amp; file_ids, <span class="namespace" sym-ref="4565.program">program</span>::<a href="../../model/include/csnap/model/translationunit.h.html#L22" class="type struct" sym-ref="4566.CompileOptions">CompileOptions</a> opts)</td></tr><tr><th id="L293">293</th><td>{</td></tr><tr><th id="L294">294</th><td>  <b>auto</b> optsptr = <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="fn" sym-ref="1396.make_shared">make_shared</span>&lt;<span class="namespace" sym-ref="4565.program">program</span>::<a href="../../model/include/csnap/model/translationunit.h.html#L22" class="type struct" sym-ref="4566.CompileOptions">CompileOptions</a>&gt;(opts);</td></tr><tr><th id="L295">295</th><td/></tr><tr><th id="L296">296</th><td>  <b>for</b> (FileId f : file_ids)</td></tr><tr><th id="L297">297</th><td>  {</td></tr><tr><th id="L298">298</th><td>    <b>auto</b> tu = std::make_unique&lt;TranslationUnit&gt;();</td></tr><tr><th id="L299">299</th><td>    tu-&gt;compile_options = optsptr;</td></tr><tr><th id="L300">300</th><td>    tu-&gt;sourcefile_id = f;</td></tr><tr><th id="L301">301</th><td/></tr><tr><th id="L302">302</th><td>    pendingData().translation_units.push_back(tu.get());</td></tr><tr><th id="L303">303</th><td/></tr><tr><th id="L304">304</th><td>    m_translationunits.add(std::move(tu));</td></tr><tr><th id="L305">305</th><td>  }</td></tr><tr><th id="L306">306</th><td>}</td></tr><tr><th id="L307">307</th><td/></tr><tr><th id="L308">308</th><td><i>/**</i></td></tr><tr><th id="L309">309</th><td><i> * \brief get a translation unit from a file</i></td></tr><tr><th id="L310">310</th><td><i> * \param file  a pointer to the file</i></td></tr><tr><th id="L311">311</th><td><i> * \return pointer to the translation unit, or nullptr if none is associated with the file</i></td></tr><tr><th id="L312">312</th><td><i> */</i></td></tr><tr><th id="L313">313</th><td><a href="../../model/include/csnap/model/translationunit.h.html#L30" class="type struct" sym-ref="4563.TranslationUnit">TranslationUnit</a>* <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4708.findTranslationUnit">findTranslationUnit</dfn>(<a href="../../model/include/csnap/model/file.h.html#L15" class="type struct" sym-ref="4532.File">File</a>* file) <em>const</em></td></tr><tr><th id="L314">314</th><td>{</td></tr><tr><th id="L315">315</th><td>  <b>return</b> <a href="snapshot.cpp.html#L331" class="member memfn" sym-ref="4710.translationUnits">translationUnits</a>().<a href="../../model/src/translationunitlist.cpp.html#L66" class="member memfn" sym-ref="4576.find">find</a>(<a href="../../model/include/csnap/model/fileid.h.html#L15" class="type cxxtypealias" sym-ref="4533.FileId">FileId</a>(file-&gt;id));</td></tr><tr><th id="L316">316</th><td>}</td></tr><tr><th id="L317">317</th><td/></tr><tr><th id="L318">318</th><td><i>/**</i></td></tr><tr><th id="L319">319</th><td><i> * \brief get a translation unit by id</i></td></tr><tr><th id="L320">320</th><td><i> * \param id  the id of the translation unit</i></td></tr><tr><th id="L321">321</th><td><i> * \return a pointer to the translation unit, or nullptr if no such translation unit exists</i></td></tr><tr><th id="L322">322</th><td><i> */</i></td></tr><tr><th id="L323">323</th><td><a href="../../model/include/csnap/model/translationunit.h.html#L30" class="type struct" sym-ref="4563.TranslationUnit">TranslationUnit</a>* <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4709.getTranslationUnit">getTranslationUnit</dfn>(<a href="../../model/include/csnap/model/translationunitid.h.html#L15" class="type cxxtypealias" sym-ref="4564.TranslationUnitId">TranslationUnitId</a> id) <em>const</em></td></tr><tr><th id="L324">324</th><td>{</td></tr><tr><th id="L325">325</th><td>  <b>return</b> <a href="snapshot.cpp.html#L331" class="member memfn" sym-ref="4710.translationUnits">translationUnits</a>().<a href="../../model/src/translationunitlist.cpp.html#L49" class="member memfn" sym-ref="4575.get">get</a>(<a href="../../model/include/csnap/model/identifier.h.html#L19" class="member constructor" sym-ref="4522.Identifier<T>">id</a>);</td></tr><tr><th id="L326">326</th><td>}</td></tr><tr><th id="L327">327</th><td/></tr><tr><th id="L328">328</th><td><i>/**</i></td></tr><tr><th id="L329">329</th><td><i> * \brief returns the list of all translation units in the snapshot</i></td></tr><tr><th id="L330">330</th><td><i> */</i></td></tr><tr><th id="L331">331</th><td><em>const</em> <a href="../../model/include/csnap/model/translationunitlist.h.html#L20" class="type cxxclass" sym-ref="4572.TranslationUnitList">TranslationUnitList</a>&amp; <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4710.translationUnits">translationUnits</dfn>() <em>const</em></td></tr><tr><th id="L332">332</th><td>{</td></tr><tr><th id="L333">333</th><td>  <b>return</b> <a href="../include/csnap/database/snapshot.h.html#L97" class="member field" sym-ref="4731.m_translationunits">m_translationunits</a>;</td></tr><tr><th id="L334">334</th><td>}</td></tr><tr><th id="L335">335</th><td/></tr><tr><th id="L336">336</th><td><em>void</em> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4711.addTranslationUnitSerializedAst">addTranslationUnitSerializedAst</dfn>(<a href="../../model/include/csnap/model/translationunit.h.html#L30" class="type struct" sym-ref="4563.TranslationUnit">TranslationUnit</a>* tu, <em>const</em> std::filesystem::path&amp; astfile)</td></tr><tr><th id="L337">337</th><td>{</td></tr><tr><th id="L338">338</th><td>  <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxtypealias" sym-ref="32.string">string</span> bytes = readFile(astfile);</td></tr><tr><th id="L339">339</th><td/></tr><tr><th id="L340">340</th><td>  <a href="sqlqueries.cpp.html#L451" class="fn" sym-ref="4810.insert_translationunit_ast">insert_translationunit_ast</a>(<span class="member memfn" sym-ref="2183.operator*">*</span><a href="../include/csnap/database/snapshot.h.html#L95" class="member field" sym-ref="4729.m_database">m_database</a>, tu, bytes);</td></tr><tr><th id="L341">341</th><td>}</td></tr><tr><th id="L342">342</th><td/></tr><tr><th id="L343">343</th><td><i>/**</i></td></tr><tr><th id="L344">344</th><td><i> * \brief add information about includes to the snapshot</i></td></tr><tr><th id="L345">345</th><td><i> * \param includes the list of includes</i></td></tr><tr><th id="L346">346</th><td><i> * \param tu       the translation unit in which the includes were collected</i></td></tr><tr><th id="L347">347</th><td><i> */</i></td></tr><tr><th id="L348">348</th><td><em>void</em> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4857.addIncludes">addIncludes</dfn>(<em>const</em> std::vector&lt;Include&gt;&amp; includes, <a href="../../model/include/csnap/model/translationunit.h.html#L30" class="type struct" sym-ref="4563.TranslationUnit">TranslationUnit</a>* tu)</td></tr><tr><th id="L349">349</th><td>{</td></tr><tr><th id="L350">350</th><td>  std::vector&lt;Include&gt;&amp; list = pendingData().includes[tu];</td></tr><tr><th id="L351">351</th><td>  list.insert(list.end(), includes.begin(), includes.end());</td></tr><tr><th id="L352">352</th><td>}</td></tr><tr><th id="L353">353</th><td/></tr><tr><th id="L354">354</th><td><i>/**</i></td></tr><tr><th id="L355">355</th><td><i> * \brief returns the list of files included in a given file</i></td></tr><tr><th id="L356">356</th><td><i> * \param f the id of the file which #include are listed</i></td></tr><tr><th id="L357">357</th><td><i> */</i></td></tr><tr><th id="L358">358</th><td>std::vector&lt;Include&gt; <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4713.listIncludesInFile">listIncludesInFile</dfn>(FileId f) <em>const</em></td></tr><tr><th id="L359">359</th><td>{</td></tr><tr><th id="L360">360</th><td>  <b>return</b> select_from_include(*m_database, f, FileId());</td></tr><tr><th id="L361">361</th><td>}</td></tr><tr><th id="L362">362</th><td/></tr><tr><th id="L363">363</th><td><i>/**</i></td></tr><tr><th id="L364">364</th><td><i> * \brief returns the list of files in which a file is included</i></td></tr><tr><th id="L365">365</th><td><i> * \param f the id of the file that is included</i></td></tr><tr><th id="L366">366</th><td><i> */</i></td></tr><tr><th id="L367">367</th><td>std::vector&lt;Include&gt; <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4714.findWhereFileIsIncluded">findWhereFileIsIncluded</dfn>(FileId f) <em>const</em></td></tr><tr><th id="L368">368</th><td>{</td></tr><tr><th id="L369">369</th><td>  <b>return</b> select_from_include(*m_database, FileId(), f);</td></tr><tr><th id="L370">370</th><td>}</td></tr><tr><th id="L371">371</th><td/></tr><tr><th id="L372">372</th><td><em>void</em> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4858.addSymbols">addSymbols</dfn>(<em>const</em> std::vector&lt;std::shared_ptr&lt;Symbol&gt;&gt;&amp; symbols)</td></tr><tr><th id="L373">373</th><td>{</td></tr><tr><th id="L374">374</th><td>  <b>auto</b>&amp; pending_list = <a href="snapshot.cpp.html#L577" class="member memfn" sym-ref="4728.pendingData">pendingData</a>().symbols;</td></tr><tr><th id="L375">375</th><td>  pending_list.insert(pending_list.end(), symbols.begin(), symbols.end());</td></tr><tr><th id="L376">376</th><td/></tr><tr><th id="L377">377</th><td>  symbolCache().insert(symbols.begin(), symbols.end());</td></tr><tr><th id="L378">378</th><td>}</td></tr><tr><th id="L379">379</th><td/></tr><tr><th id="L380">380</th><td><i>/**</i></td></tr><tr><th id="L381">381</th><td><i> * \brief retrieves a symbol by its id</i></td></tr><tr><th id="L382">382</th><td><i> * \param id      the id of the symbol</i></td></tr><tr><th id="L383">383</th><td><i> * \param loader  an optional loader to use if the symbol is not in the cache</i></td></tr><tr><th id="L384">384</th><td><i> * </i></td></tr><tr><th id="L385">385</th><td><i> * If \a loader is nullptr and the symbol isn't in the case, a local SymbolLoader </i></td></tr><tr><th id="L386">386</th><td><i> * is created.</i></td></tr><tr><th id="L387">387</th><td><i> * If you only want to retrieve a symbol if it is already loaded, use SymbolCache::find().</i></td></tr><tr><th id="L388">388</th><td><i> */</i></td></tr><tr><th id="L389">389</th><td><a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxclass" sym-ref="506.shared_ptr">shared_ptr</span>&lt;<a href="../../model/include/csnap/model/symbol.h.html#L63" class="type struct" sym-ref="4580.Symbol">Symbol</a>&gt; <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4716.getSymbol">getSymbol</dfn>(<a href="../../model/include/csnap/model/symbolid.h.html#L15" class="type cxxtypealias" sym-ref="4581.SymbolId">SymbolId</a> id, <a href="../include/csnap/database/symbolloader.h.html#L20" class="type cxxclass" sym-ref="4685.SymbolLoader">SymbolLoader</a>* loader)</td></tr><tr><th id="L390">390</th><td>{</td></tr><tr><th id="L391">391</th><td>  <b>if</b> (std::shared_ptr&lt;Symbol&gt; symbol = symbolCache().find(id))</td></tr><tr><th id="L392">392</th><td>    <b>return</b> symbol;</td></tr><tr><th id="L393">393</th><td/></tr><tr><th id="L394">394</th><td>  <b>auto</b> load_symbol = [<b>this</b>, <a href="../../model/include/csnap/model/identifier.h.html#L19" class="member constructor" sym-ref="4522.Identifier<T>">id</a>](<a href="../include/csnap/database/symbolloader.h.html#L20" class="type cxxclass" sym-ref="4685.SymbolLoader">SymbolLoader</a>&amp; theloader) -&gt; <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxclass" sym-ref="506.shared_ptr">shared_ptr</span>&lt;<a href="../../model/include/csnap/model/symbol.h.html#L63" class="type struct" sym-ref="4580.Symbol">Symbol</a>&gt; {</td></tr><tr><th id="L395">395</th><td>    <b>if</b> (!theloader.read(id))</td></tr><tr><th id="L396">396</th><td>      <b>return</b> <b>nullptr</b>;</td></tr><tr><th id="L397">397</th><td/></tr><tr><th id="L398">398</th><td>    <b>auto</b> symbol = <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="fn" sym-ref="1396.make_shared">make_shared</span>&lt;<a href="../../model/include/csnap/model/symbol.h.html#L63" class="type struct" sym-ref="4580.Symbol">Symbol</a>&gt;(<a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="fn" sym-ref="1400.move">move</span>(theloader.symbol));</td></tr><tr><th id="L399">399</th><td>    symbolCache().insert(symbol);</td></tr><tr><th id="L400">400</th><td>    <b>return</b> symbol;</td></tr><tr><th id="L401">401</th><td>  };</td></tr><tr><th id="L402">402</th><td/></tr><tr><th id="L403">403</th><td>  <b>if</b> (loader)</td></tr><tr><th id="L404">404</th><td>  {</td></tr><tr><th id="L405">405</th><td>    <b>return</b> load_symbol(*loader);</td></tr><tr><th id="L406">406</th><td>  }</td></tr><tr><th id="L407">407</th><td>  <b>else</b></td></tr><tr><th id="L408">408</th><td>  {</td></tr><tr><th id="L409">409</th><td>    <a href="../include/csnap/database/symbolloader.h.html#L20" class="type cxxclass" sym-ref="4685.SymbolLoader">SymbolLoader</a> <a href="symbolloader.cpp.html#L23" class="member constructor" sym-ref="4826.SymbolLoader">local_loader</a>{ *<b>this</b> };</td></tr><tr><th id="L410">410</th><td>    <b>return</b> load_symbol(local_loader);</td></tr><tr><th id="L411">411</th><td>  }</td></tr><tr><th id="L412">412</th><td>}</td></tr><tr><th id="L413">413</th><td/></tr><tr><th id="L414">414</th><td><i>/**</i></td></tr><tr><th id="L415">415</th><td><i> * \brief retrieves a list of symbols</i></td></tr><tr><th id="L416">416</th><td><i> * \param ids  the ids of the symbol to retrieve</i></td></tr><tr><th id="L417">417</th><td><i> * </i></td></tr><tr><th id="L418">418</th><td><i> * If the requested symbols are no in the cache, they are loaded from the database.</i></td></tr><tr><th id="L419">419</th><td><i> */</i></td></tr><tr><th id="L420">420</th><td>std::map&lt;SymbolId, std::shared_ptr&lt;Symbol&gt;&gt; <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4859.loadSymbols">loadSymbols</dfn>(<em>const</em> std::set&lt;SymbolId&gt;&amp; ids)</td></tr><tr><th id="L421">421</th><td>{</td></tr><tr><th id="L422">422</th><td>  std::map&lt;SymbolId, std::shared_ptr&lt;Symbol&gt;&gt; r;</td></tr><tr><th id="L423">423</th><td>  loadSymbols(ids, r);</td></tr><tr><th id="L424">424</th><td>  <b>return</b> r;</td></tr><tr><th id="L425">425</th><td>}</td></tr><tr><th id="L426">426</th><td/></tr><tr><th id="L427">427</th><td><i>/**</i></td></tr><tr><th id="L428">428</th><td><i> * \brief retrieves a list of symbols</i></td></tr><tr><th id="L429">429</th><td><i> * \param ids     ids of the symbol to retrieve</i></td></tr><tr><th id="L430">430</th><td><i> * \param outmap  the output map in which the results are written</i></td></tr><tr><th id="L431">431</th><td><i> * \return the pair (number of symbol loaded from the database, number of symbol found in the cache)</i></td></tr><tr><th id="L432">432</th><td><i> */</i></td></tr><tr><th id="L433">433</th><td><a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="type cxxclass" sym-ref="170.pair">pair</span>&lt;size_t, size_t&gt; <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4860.loadSymbols">loadSymbols</dfn>(<em>const</em> std::set&lt;SymbolId&gt;&amp; ids, std::map&lt;SymbolId, std::shared_ptr&lt;Symbol&gt;&gt;&amp; outmap)</td></tr><tr><th id="L434">434</th><td>{</td></tr><tr><th id="L435">435</th><td>  <a href="../include/csnap/database/symbolloader.h.html#L20" class="type cxxclass" sym-ref="4685.SymbolLoader">SymbolLoader</a> <a href="symbolloader.cpp.html#L12" class="member constructor" sym-ref="4825.SymbolLoader">loader</a>{ <span class="member memfn" sym-ref="2183.operator*">*</span><a href="../include/csnap/database/snapshot.h.html#L95" class="member field" sym-ref="4729.m_database">m_database</a> };</td></tr><tr><th id="L436">436</th><td/></tr><tr><th id="L437">437</th><td>  size_t loaded = <var>0</var>;</td></tr><tr><th id="L438">438</th><td>  size_t cache = <var>0</var>;</td></tr><tr><th id="L439">439</th><td/></tr><tr><th id="L440">440</th><td>  <b>for</b> (SymbolId id : ids)</td></tr><tr><th id="L441">441</th><td>  {</td></tr><tr><th id="L442">442</th><td>    <b>if</b> (std::shared_ptr&lt;Symbol&gt; symbol = symbolCache().find(id))</td></tr><tr><th id="L443">443</th><td>    {</td></tr><tr><th id="L444">444</th><td>      ++cache;</td></tr><tr><th id="L445">445</th><td>      outmap[symbol-&gt;id] = symbol;</td></tr><tr><th id="L446">446</th><td>    }</td></tr><tr><th id="L447">447</th><td>    <b>else</b> <b>if</b>(loader.read(id))</td></tr><tr><th id="L448">448</th><td>    {</td></tr><tr><th id="L449">449</th><td>      ++loaded;</td></tr><tr><th id="L450">450</th><td>      outmap[id] = std::make_shared&lt;Symbol&gt;(std::move(loader.symbol));</td></tr><tr><th id="L451">451</th><td>    }</td></tr><tr><th id="L452">452</th><td>  }</td></tr><tr><th id="L453">453</th><td/></tr><tr><th id="L454">454</th><td>  <b>return</b> <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="fn" sym-ref="2253.make_pair">make_pair</span>(loaded, cache);</td></tr><tr><th id="L455">455</th><td>}</td></tr><tr><th id="L456">456</th><td/></tr><tr><th id="L457">457</th><td><em>void</em> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4861.addSymbolReferences">addSymbolReferences</dfn>(<em>const</em> std::vector&lt;SymbolReference&gt;&amp; list)</td></tr><tr><th id="L458">458</th><td>{</td></tr><tr><th id="L459">459</th><td>  <b>auto</b>&amp; pending_list = <a href="snapshot.cpp.html#L577" class="member memfn" sym-ref="4728.pendingData">pendingData</a>().symbol_references;</td></tr><tr><th id="L460">460</th><td>  pending_list.insert(pending_list.end(), list.begin(), list.end());</td></tr><tr><th id="L461">461</th><td>}</td></tr><tr><th id="L462">462</th><td/></tr><tr><th id="L463">463</th><td><i>/**</i></td></tr><tr><th id="L464">464</th><td><i> * \brief list all references of a symbol</i></td></tr><tr><th id="L465">465</th><td><i> * \param symbol  the id of the symbol</i></td></tr><tr><th id="L466">466</th><td><i> * </i></td></tr><tr><th id="L467">467</th><td><i> * Declarations and definitions are also considered to be references </i></td></tr><tr><th id="L468">468</th><td><i> * in this function.</i></td></tr><tr><th id="L469">469</th><td><i> * </i></td></tr><tr><th id="L470">470</th><td><i> * The references are listed in no particular order.</i></td></tr><tr><th id="L471">471</th><td><i> */</i></td></tr><tr><th id="L472">472</th><td>std::vector&lt;SymbolReference&gt; <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4724.listReferences">listReferences</dfn>(SymbolId symbol)</td></tr><tr><th id="L473">473</th><td>{</td></tr><tr><th id="L474">474</th><td>  <b>return</b> select_from_symbolreference(*m_database, symbol);</td></tr><tr><th id="L475">475</th><td>}</td></tr><tr><th id="L476">476</th><td/></tr><tr><th id="L477">477</th><td><i>/**</i></td></tr><tr><th id="L478">478</th><td><i> * \brief list all symbol references in a file</i></td></tr><tr><th id="L479">479</th><td><i> * \param file  the id of the file</i></td></tr><tr><th id="L480">480</th><td><i> * </i></td></tr><tr><th id="L481">481</th><td><i> * Use this function to get a list of all symbols that are referenced in a file.</i></td></tr><tr><th id="L482">482</th><td><i> */</i></td></tr><tr><th id="L483">483</th><td>std::vector&lt;SymbolReference&gt; <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4725.listReferencesInFile">listReferencesInFile</dfn>(FileId file)</td></tr><tr><th id="L484">484</th><td>{</td></tr><tr><th id="L485">485</th><td>  <b>return</b> select_symbolreference(*m_database, file);</td></tr><tr><th id="L486">486</th><td>}</td></tr><tr><th id="L487">487</th><td/></tr><tr><th id="L488">488</th><td><i>/**</i></td></tr><tr><th id="L489">489</th><td><i> * \brief returns the symbol cache</i></td></tr><tr><th id="L490">490</th><td><i> * </i></td></tr><tr><th id="L491">491</th><td><i> * This cache is used by the snapshot to avoid reloading symbols </i></td></tr><tr><th id="L492">492</th><td><i> * from the database when they have already been loaded recently.</i></td></tr><tr><th id="L493">493</th><td><i> */</i></td></tr><tr><th id="L494">494</th><td><a href="../../model/include/csnap/model/symbolcache.h.html#L16" class="type cxxclass" sym-ref="4677.SymbolCache">SymbolCache</a>&amp; <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4719.symbolCache">symbolCache</dfn>()</td></tr><tr><th id="L495">495</th><td>{</td></tr><tr><th id="L496">496</th><td>  <b>return</b> <a href="../include/csnap/database/snapshot.h.html#L99" class="member field" sym-ref="4733.m_symbol_cache">m_symbol_cache</a>;</td></tr><tr><th id="L497">497</th><td>}</td></tr><tr><th id="L498">498</th><td/></tr><tr><th id="L499">499</th><td><i>/**</i></td></tr><tr><th id="L500">500</th><td><i> * \brief adds a list of base classes for a symbol</i></td></tr><tr><th id="L501">501</th><td><i> */</i></td></tr><tr><th id="L502">502</th><td><em>void</em> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4862.addBases">addBases</dfn>(<a href="../../model/include/csnap/model/symbolid.h.html#L15" class="type cxxtypealias" sym-ref="4581.SymbolId">SymbolId</a> symid, <em>const</em> std::vector&lt;BaseClass&gt;&amp; bases)</td></tr><tr><th id="L503">503</th><td>{</td></tr><tr><th id="L504">504</th><td>  <b>if</b> (symid.<a href="../../model/include/csnap/model/identifier.h.html#L33" class="member memfn" sym-ref="4526.valid">valid</a>())</td></tr><tr><th id="L505">505</th><td>  {</td></tr><tr><th id="L506">506</th><td>    std::vector&lt;BaseClass&gt;&amp; list = pendingData().bases[symid];</td></tr><tr><th id="L507">507</th><td>    list.insert(list.end(), bases.begin(), bases.end());</td></tr><tr><th id="L508">508</th><td>  }</td></tr><tr><th id="L509">509</th><td>}</td></tr><tr><th id="L510">510</th><td/></tr><tr><th id="L511">511</th><td><i>/**</i></td></tr><tr><th id="L512">512</th><td><i> * \brief returns the base classes of a symbol</i></td></tr><tr><th id="L513">513</th><td><i> * \param symid  the id of the symbol</i></td></tr><tr><th id="L514">514</th><td><i> * </i></td></tr><tr><th id="L515">515</th><td><i> * You may call this function with an id that does not represent a C++ class</i></td></tr><tr><th id="L516">516</th><td><i> * (or with an invalid id); in such case, an empty vector is returned. </i></td></tr><tr><th id="L517">517</th><td><i> */</i></td></tr><tr><th id="L518">518</th><td>std::vector&lt;BaseClass&gt; <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4721.listBaseClasses">listBaseClasses</dfn>(SymbolId symid) <em>const</em></td></tr><tr><th id="L519">519</th><td>{</td></tr><tr><th id="L520">520</th><td>  <b>return</b> select_from_base(*m_database, symid);</td></tr><tr><th id="L521">521</th><td>}</td></tr><tr><th id="L522">522</th><td/></tr><tr><th id="L523">523</th><td><i>/**</i></td></tr><tr><th id="L524">524</th><td><i> * \brief returns known derived classes of a symbol</i></td></tr><tr><th id="L525">525</th><td><i> * \param symid  the id of the symbol</i></td></tr><tr><th id="L526">526</th><td><i> * </i></td></tr><tr><th id="L527">527</th><td><i> * \sa listBaseClasses().</i></td></tr><tr><th id="L528">528</th><td><i> */</i></td></tr><tr><th id="L529">529</th><td>std::vector&lt;SymbolId&gt; <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4722.listDerivedClasses">listDerivedClasses</dfn>(SymbolId symid) <em>const</em></td></tr><tr><th id="L530">530</th><td>{</td></tr><tr><th id="L531">531</th><td>  <b>return</b> select_symbold_id_from_base(*m_database, symid);</td></tr><tr><th id="L532">532</th><td>}</td></tr><tr><th id="L533">533</th><td/></tr><tr><th id="L534">534</th><td><em>bool</em> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4726.hasPendingData">hasPendingData</dfn>() <em>const</em></td></tr><tr><th id="L535">535</th><td>{</td></tr><tr><th id="L536">536</th><td>  <b>return</b> <a href="../include/csnap/database/snapshot.h.html#L100" class="member field" sym-ref="4734.m_pending_data">m_pending_data</a> != <b>nullptr</b>;</td></tr><tr><th id="L537">537</th><td>}</td></tr><tr><th id="L538">538</th><td/></tr><tr><th id="L539">539</th><td><em>void</em> <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4727.writePendingData">writePendingData</dfn>()</td></tr><tr><th id="L540">540</th><td>{</td></tr><tr><th id="L541">541</th><td>  <b>if</b> (!<a href="snapshot.cpp.html#L534" class="member memfn" sym-ref="4726.hasPendingData">hasPendingData</a>())</td></tr><tr><th id="L542">542</th><td>    <b>return</b>;</td></tr><tr><th id="L543">543</th><td/></tr><tr><th id="L544">544</th><td>  <span class="namespace" sym-ref="4774.sql">sql</span>::<a href="../include/csnap/database/transaction.h.html#L19" class="type cxxclass" sym-ref="4835.Transaction">Transaction</a> <a href="../include/csnap/database/transaction.h.html#L35" class="member constructor" sym-ref="4837.Transaction">transaction</a>{ <span class="member memfn" sym-ref="2183.operator*">*</span><a href="../include/csnap/database/snapshot.h.html#L95" class="member field" sym-ref="4729.m_database">m_database</a> };</td></tr><tr><th id="L545">545</th><td/></tr><tr><th id="L546">546</th><td>  <b>for</b> (<em>const</em> std::pair&lt;<em>const</em> std::string, std::string&gt;&amp; p : m_pending_data-&gt;properties)</td></tr><tr><th id="L547">547</th><td>  {</td></tr><tr><th id="L548">548</th><td>    insert_info(*m_database, p.first, p.second);</td></tr><tr><th id="L549">549</th><td>  }</td></tr><tr><th id="L550">550</th><td/></tr><tr><th id="L551">551</th><td>  <b>for</b> (FileId f : m_pending_data-&gt;files)</td></tr><tr><th id="L552">552</th><td>  {</td></tr><tr><th id="L553">553</th><td>    insert_file(*m_database, *m_files.get(f));</td></tr><tr><th id="L554">554</th><td>  }</td></tr><tr><th id="L555">555</th><td/></tr><tr><th id="L556">556</th><td>  <a href="sqlqueries.cpp.html#L431" class="fn" sym-ref="4809.insert_translationunit">insert_translationunit</a>(<span class="member memfn" sym-ref="2183.operator*">*</span><a href="../include/csnap/database/snapshot.h.html#L95" class="member field" sym-ref="4729.m_database">m_database</a>, <a href="../include/csnap/database/snapshot.h.html#L100" class="member field" sym-ref="4734.m_pending_data">m_pending_data</a>-&gt;translation_units);</td></tr><tr><th id="L557">557</th><td/></tr><tr><th id="L558">558</th><td>  <b>for</b> (<em>const</em> std::pair&lt;TranslationUnit* <em>const</em>, std::vector&lt;Include&gt;&gt;&amp; p : m_pending_data-&gt;includes)</td></tr><tr><th id="L559">559</th><td>  {</td></tr><tr><th id="L560">560</th><td>    <b>if</b> (p.first)</td></tr><tr><th id="L561">561</th><td>    {</td></tr><tr><th id="L562">562</th><td>      insert_ppinclude(*m_database, *p.first, p.second);</td></tr><tr><th id="L563">563</th><td>    }</td></tr><tr><th id="L564">564</th><td/></tr><tr><th id="L565">565</th><td>    insert_includes(*m_database, p.second);</td></tr><tr><th id="L566">566</th><td>  }</td></tr><tr><th id="L567">567</th><td/></tr><tr><th id="L568">568</th><td>  <a href="sqlqueries.cpp.html#L502" class="fn" sym-ref="4813.insert_symbol">insert_symbol</a>(<span class="member memfn" sym-ref="2183.operator*">*</span><a href="../include/csnap/database/snapshot.h.html#L95" class="member field" sym-ref="4729.m_database">m_database</a>, <a href="../include/csnap/database/snapshot.h.html#L100" class="member field" sym-ref="4734.m_pending_data">m_pending_data</a>-&gt;symbols);</td></tr><tr><th id="L569">569</th><td/></tr><tr><th id="L570">570</th><td>  <a href="sqlqueries.cpp.html#L585" class="fn" sym-ref="4816.insert_base">insert_base</a>(<span class="member memfn" sym-ref="2183.operator*">*</span><a href="../include/csnap/database/snapshot.h.html#L95" class="member field" sym-ref="4729.m_database">m_database</a>, <a href="../include/csnap/database/snapshot.h.html#L100" class="member field" sym-ref="4734.m_pending_data">m_pending_data</a>-&gt;bases);</td></tr><tr><th id="L571">571</th><td/></tr><tr><th id="L572">572</th><td>  <a href="sqlqueries.cpp.html#L557" class="fn" sym-ref="4815.insert_symbol_references">insert_symbol_references</a>(<span class="member memfn" sym-ref="2183.operator*">*</span><a href="../include/csnap/database/snapshot.h.html#L95" class="member field" sym-ref="4729.m_database">m_database</a>, <a href="../include/csnap/database/snapshot.h.html#L100" class="member field" sym-ref="4734.m_pending_data">m_pending_data</a>-&gt;symbol_references);</td></tr><tr><th id="L573">573</th><td/></tr><tr><th id="L574">574</th><td>  <a href="../include/csnap/database/snapshot.h.html#L100" class="member field" sym-ref="4734.m_pending_data">m_pending_data</a>.<span class="member memfn" sym-ref="4863.reset">reset</span>();</td></tr><tr><th id="L575">575</th><td>}</td></tr><tr><th id="L576">576</th><td/></tr><tr><th id="L577">577</th><td><a href="snapshot.cpp.html#L20" class="type struct" sym-ref="4684.PendingData">PendingData</a>&amp; <a href="../include/csnap/database/snapshot.h.html#L34" class="type cxxclass" sym-ref="4686.Snapshot">Snapshot</a>::<dfn class="member memfn" sym-ref="4728.pendingData">pendingData</dfn>()</td></tr><tr><th id="L578">578</th><td>{</td></tr><tr><th id="L579">579</th><td>  <b>if</b> (!<span class="member convfn" sym-ref="2416.operator bool">m_pending_data</span>)</td></tr><tr><th id="L580">580</th><td>    <a href="../include/csnap/database/snapshot.h.html#L100" class="member field" sym-ref="4734.m_pending_data">m_pending_data</a> = <a href="../../indexer/libclang-utils/include/libclang-utils/clang-cursor.h.html#L526" class="namespace" sym-ref="4.std">std</a>::<span class="fn" sym-ref="4850.make_unique">make_unique</span>&lt;PendingData&gt;();</td></tr><tr><th id="L581">581</th><td>  <b>return</b> <span class="member memfn" sym-ref="2183.operator*">*</span><a href="../include/csnap/database/snapshot.h.html#L100" class="member field" sym-ref="4734.m_pending_data">m_pending_data</a>;</td></tr><tr><th id="L582">582</th><td>}</td></tr><tr><th id="L583">583</th><td/></tr><tr><th id="L584">584</th><td>} <i>// namespace csnap</i></td></tr></tbody></table></div></body></html>